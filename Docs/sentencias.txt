 SELECT * FROM(SELECT IDPRODUCTO, COUNT(IDPRODUCTO) AS TOTAL FROM ((SELECT IDPEDIDO, TO_CHAR(FECHAYHORA,'DY' ) AS DY FROM PEDIDO )NATURAL JOIN PEDIDOPRODUCTO) NATURAL JOIN PRODUCTO  WHERE DY='DOM'  GROUP BY IDPRODUCTO)NATURAL JOIN(SELECT  MAX(TOTAL)AS TOTAL  FROM(SELECT IDPRODUCTO, COUNT(IDPRODUCTO) AS TOTAL FROM ((SELECT IDPEDIDO, TO_CHAR(FECHAYHORA,'DY' ) AS DY FROM PEDIDO )NATURAL JOIN PEDIDOPRODUCTO) NATURAL JOIN PRODUCTO  WHERE DY='DOM'  GROUP BY IDPRODUCTO) );

 SELECT * FROM(SELECT LOCAL, COUNT(LOCAL) AS TOTAL FROM ((SELECT IDPEDIDO, TO_CHAR(FECHAYHORA,'DY' ) AS DY FROM PEDIDO )NATURAL JOIN PEDIDOPRODUCTO) NATURAL JOIN RESTAURANTE  WHERE DY='DOM'  GROUP BY LOCAL)NATURAL JOIN(SELECT  MAX(TOTAL)AS TOTAL  FROM(SELECT LOCAL, COUNT(LOCAL) AS TOTAL FROM ((SELECT IDPEDIDO, TO_CHAR(FECHAYHORA,'DY' ) AS DY FROM PEDIDO )NATURAL JOIN PEDIDOPRODUCTO) NATURAL JOIN RESTAURANTE  WHERE DY='DOM'  GROUP BY LOCAL) );

 SELECT * FROM(SELECT IDPRODUCTO, COUNT(IDPRODUCTO) AS TOTAL FROM ((SELECT IDPEDIDO, TO_CHAR(FECHAYHORA,'DY' ) AS DY FROM PEDIDO )NATURAL JOIN PEDIDOPRODUCTO) NATURAL JOIN PRODUCTO  WHERE DY='DOM'  GROUP BY IDPRODUCTO)NATURAL JOIN(SELECT  MIN(TOTAL)AS TOTAL  FROM(SELECT IDPRODUCTO, COUNT(IDPRODUCTO) AS TOTAL FROM ((SELECT IDPEDIDO, TO_CHAR(FECHAYHORA,'DY' ) AS DY FROM PEDIDO )NATURAL JOIN PEDIDOPRODUCTO) NATURAL JOIN PRODUCTO  WHERE DY='DOM'  GROUP BY IDPRODUCTO) );

 SELECT * FROM(SELECT LOCAL, COUNT(LOCAL) AS TOTAL FROM ((SELECT IDPEDIDO, TO_CHAR(FECHAYHORA,'DY' ) AS DY FROM PEDIDO )NATURAL JOIN PEDIDOPRODUCTO) NATURAL JOIN RESTAURANTE  WHERE DY='DOM'  GROUP BY LOCAL)NATURAL JOIN(SELECT  MIN(TOTAL)AS TOTAL  FROM(SELECT LOCAL, COUNT(LOCAL) AS TOTAL FROM ((SELECT IDPEDIDO, TO_CHAR(FECHAYHORA,'DY' ) AS DY FROM PEDIDO )NATURAL JOIN PEDIDOPRODUCTO) NATURAL JOIN RESTAURANTE  WHERE DY='DOM'  GROUP BY LOCAL) );

SELECT CEDULA, NOMBRE, EMAIL, ROL FROM ((SELECT CEDULA, NOMBRE, ROL, EMAIL FROM (PEDIDO NATURAL JOIN PEDIDOPRODUCTO) NATURAL JOIN USUARIO WHERE CEDULA NOT IN (SELECT CEDULA FROM (PEDIDO NATURAL JOIN PEDIDOMENU) NATURAL JOIN USUARIO CEDULA ) UNION (SELECT  CEDULA,NOM AS NOMBRE, ROL, EMAIL FROM ((PEDIDO NATURAL JOIN (SELECT CEDULA, ROL, EMAIL, NOMBRE AS NOM FROM USUARIO)) INNER JOIN (PEDIDOPRODUCTO NATURAL JOIN (PRODUCTO NATURAL JOIN OFRECEPRODUCTO))  ON PEDIDO.IDPEDIDO=PEDIDOPRODUCTO.IDPEDIDO) WHERE IDCATEGORIA=2 AND PRECIO>=36885.855 )))UNION (SELECT CEDULA, NOMBRE,EMAIL,ROL  FROM(SELECT SUM(NUMWEEKS) AS TOTALWEEKS FROM (SELECT COUNT(DISTINCT(WEEK)) AS NUMWEEKS,YEAR FROM(SELECT IDPEDIDO, EXTRACT(YEAR FROM FECHAYHORA) AS YEAR, to_number(to_char(FECHAYHORA,'WW')) AS WEEK FROM (PEDIDO )) GROUP BY YEAR)) NATURAL JOIN (SELECT NOMBRE, ROL, CEDULA, EMAIL, SUM(NUMWEEKS) AS TOTALWEEKS FROM (SELECT COUNT(*) AS NUMWEEKS, NOMBRE, CEDULA, EMAIL, ROL, YEAR FROM (SELECT  EXTRACT(YEAR FROM FECHAYHORA)AS YEAR, CEDULA, ROL, NoMBRE, EMAIL , to_number(to_char(FECHAYHORA,'WW')) AS WEEK FROM (PEDIDO NATURAL JOIN USUARIO)) GROUP BY NOMBRE, ROL, CEDULA, EMAIL, YEAR) GROUP BY NOMBRE, ROL, CEDULA, EMAIL));